import{c as i,Y as h,j as f,w as y,o as e,q as d,A as g,D as n,Z as j,G as l,_ as N,F as b,H as w,W as v,J as C}from"./index-BctlDaup.js";import{u as S}from"./useMutation-BDj03tzs.js";import{S as L}from"./search-BPS-0_Up.js";import{U}from"./user-BSZ3wGdp.js";const k=i("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);const D=i("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),q=b(l,"users"),R=async()=>{try{const r=w(q,v("createdAt","desc"));return(await C(r)).docs.map(s=>({...s.data(),uid:s.id}))}catch(r){return console.error("Error fetching users:",r),[]}},z=async(r,a)=>{try{const s=j(l,"users",r);return await N(s,{role:a}),!0}catch(s){return console.error("Error updating user role:",s),!1}};function K(){const r=h(),[a,s]=f.useState(""),{data:c=[],isLoading:A,error:F}=y({queryKey:["users"],queryFn:R}),m=S({mutationFn:({uid:t,role:o})=>z(t,o),onSuccess:()=>{r.invalidateQueries({queryKey:["users"]}),n.success("User role updated successfully")},onError:()=>{n.error("Failed to update user role")}}),u=c.filter(t=>t.email.toLowerCase().includes(a.toLowerCase())||t.displayName?.toLowerCase().includes(a.toLowerCase())),x=(t,o)=>{const p=o==="admin"?"customer":"admin";m.mutate({uid:t,role:p})};return e.jsxs("div",{children:[e.jsxs(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"font-serif text-3xl font-bold text-foreground mb-2",children:"User Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage user accounts and permissions"})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"relative",children:[e.jsx(L,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground"}),e.jsx("input",{type:"text",value:a,onChange:t=>s(t.target.value),placeholder:"Search users...",className:`pl-10 pr-4 py-2 rounded-xl bg-input border border-border text-foreground\r
                         focus:outline-none focus:ring-2 focus:ring-primary w-64`})]})})]}),e.jsx(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.5},children:e.jsx(g,{depth:6,children:e.jsx("div",{className:"bg-gradient-card rounded-xl border border-border/50 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-muted/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"User"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Role"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Created"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Last Login"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-border",children:u.map(t=>e.jsxs("tr",{className:"hover:bg-muted/30 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[t.photoURL?e.jsx("img",{src:t.photoURL,alt:t.displayName||"User",className:"w-10 h-10 rounded-full"}):e.jsx("div",{className:"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(U,{size:20,className:"text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:t.displayName||"No name"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.email})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-3 py-1 text-xs font-medium rounded-full ${t.role==="admin"?"bg-red-500/10 text-red-500":"bg-blue-500/10 text-blue-500"}`,children:t.role})}),e.jsx("td",{className:"px-6 py-4 text-sm text-muted-foreground",children:new Date(t.createdAt).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 text-sm text-muted-foreground",children:new Date(t.lastLoginAt).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4",children:e.jsx(d.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>x(t.uid,t.role),className:`flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium ${t.role==="admin"?"bg-red-500/10 text-red-500 hover:bg-red-500/20":"bg-blue-500/10 text-blue-500 hover:bg-blue-500/20"}`,children:t.role==="admin"?e.jsxs(e.Fragment,{children:[e.jsx(k,{size:16}),"Demote"]}):e.jsxs(e.Fragment,{children:[e.jsx(D,{size:16}),"Promote"]})})})]},t.uid))})]})})})})})]})}export{K as default};
