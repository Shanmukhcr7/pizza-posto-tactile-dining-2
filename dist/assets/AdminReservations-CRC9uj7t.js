import{Y as g,j as l,w as j,o as e,q as o,A as y,C as N,X as b,D as c,Z as v,G as u,_ as w,F as C,H as S,W as k,J as q}from"./index-BctlDaup.js";import{u as R}from"./useMutation-BDj03tzs.js";import{S as D}from"./search-BPS-0_Up.js";import{C as F}from"./check-CJs2ub9-.js";const E=C(u,"reservations"),L=async()=>{try{const r=S(E,k("date","desc"));return(await q(r)).docs.map(s=>({id:s.id,...s.data()}))}catch(r){return console.error("Error fetching reservations:",r),[]}},z=async(r,a)=>{try{const s=v(u,"reservations",r);return await w(s,{status:a}),!0}catch(s){return console.error("Error updating reservation:",s),!1}};function K(){const r=g(),[a,s]=l.useState(""),[d,x]=l.useState("all"),{data:m=[],isLoading:A,error:H}=j({queryKey:["reservations"],queryFn:L}),p=R({mutationFn:({id:t,status:n})=>z(t,n),onSuccess:()=>{r.invalidateQueries({queryKey:["reservations"]}),c.success("Reservation status updated")},onError:()=>{c.error("Failed to update reservation")}}),h=m.filter(t=>{const n=t.name.toLowerCase().includes(a.toLowerCase())||t.email.toLowerCase().includes(a.toLowerCase()),f=d==="all"||t.status===d;return n&&f}),i=(t,n)=>{p.mutate({id:t,status:n})};return e.jsxs("div",{children:[e.jsxs(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"font-serif text-3xl font-bold text-foreground mb-2",children:"Reservations"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage all restaurant bookings"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(D,{size:18,className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground"}),e.jsx("input",{type:"text",value:a,onChange:t=>s(t.target.value),placeholder:"Search guests...",className:`pl-10 pr-4 py-2 rounded-xl bg-input border border-border text-foreground \r
                         focus:outline-none focus:ring-2 focus:ring-primary w-64`})]}),e.jsxs("select",{value:d,onChange:t=>x(t.target.value),className:`px-4 py-2 rounded-xl bg-input border border-border text-foreground \r
                       focus:outline-none focus:ring-2 focus:ring-primary appearance-none cursor-pointer`,children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"confirmed",children:"Confirmed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]})]}),e.jsx(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.5},children:e.jsx(y,{depth:6,children:e.jsx("div",{className:"bg-gradient-card rounded-xl border border-border/50 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-muted/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Guest Details"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Date & Time"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Party"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Notes"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-border",children:h.map(t=>e.jsxs("tr",{className:"hover:bg-muted/30 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:t.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.email}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.phone})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{size:16,className:"text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-foreground",children:t.date}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.time})]})]})}),e.jsxs("td",{className:"px-6 py-4 text-foreground",children:[t.guests," guests"]}),e.jsx("td",{className:"px-6 py-4 text-sm text-muted-foreground max-w-48 truncate",children:t.notes||"-"}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-3 py-1 text-xs font-medium rounded-full ${t.status==="confirmed"?"bg-green-500/10 text-green-500":t.status==="cancelled"?"bg-red-500/10 text-red-500":"bg-yellow-500/10 text-yellow-500"}`,children:t.status})}),e.jsx("td",{className:"px-6 py-4",children:t.status==="pending"&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(o.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>i(t.id,"confirmed"),className:"p-2 rounded-lg bg-green-500/10 text-green-500 hover:bg-green-500/20",children:e.jsx(F,{size:16})}),e.jsx(o.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>i(t.id,"cancelled"),className:"p-2 rounded-lg bg-red-500/10 text-red-500 hover:bg-red-500/20",children:e.jsx(b,{size:16})})]})})]},t.id))})]})})})})})]})}export{K as default};
